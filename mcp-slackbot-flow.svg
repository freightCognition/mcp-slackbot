<svg viewBox="0 0 1000 800" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#333" />
    </marker>
  </defs>
  
  <!-- Title -->
  <text x="500" y="30" text-anchor="middle" font-size="20" font-weight="bold">MCP Slackbot Flow</text>
  
  <!-- Components -->
  <!-- Slack User -->
  <rect x="50" y="80" width="120" height="60" fill="#4A154B" stroke="#333" stroke-width="2" rx="5"/>
  <text x="110" y="115" text-anchor="middle" fill="white" font-size="14">Slack User</text>
  
  <!-- Slack API -->
  <rect x="50" y="200" width="120" height="60" fill="#4A154B" stroke="#333" stroke-width="2" rx="5"/>
  <text x="110" y="235" text-anchor="middle" fill="white" font-size="14">Slack API</text>
  
  <!-- Node.js App -->
  <rect x="300" y="200" width="200" height="300" fill="#68A063" stroke="#333" stroke-width="2" rx="5"/>
  <text x="400" y="230" text-anchor="middle" fill="white" font-size="14">Node.js Express</text>
  <text x="400" y="250" text-anchor="middle" fill="white" font-size="12">/slack/commands</text>
  
  <!-- Sub-components in Node.js -->
  <rect x="320" y="280" width="160" height="40" fill="#5a8f56" rx="3"/>
  <text x="400" y="305" text-anchor="middle" fill="white" font-size="11">Signature Verify</text>
  
  <rect x="320" y="340" width="160" height="40" fill="#5a8f56" rx="3"/>
  <text x="400" y="365" text-anchor="middle" fill="white" font-size="11">Token Manager</text>
  
  <rect x="320" y="400" width="160" height="40" fill="#5a8f56" rx="3"/>
  <text x="400" y="425" text-anchor="middle" fill="white" font-size="11">Response Builder</text>
  
  <!-- MCP API -->
  <rect x="650" y="200" width="150" height="60" fill="#FF6B6B" stroke="#333" stroke-width="2" rx="5"/>
  <text x="725" y="235" text-anchor="middle" fill="white" font-size="14">MCP API</text>
  
  <!-- OAuth -->
  <rect x="650" y="320" width="150" height="60" fill="#FF6B6B" stroke="#333" stroke-width="2" rx="5"/>
  <text x="725" y="355" text-anchor="middle" fill="white" font-size="14">OAuth Token</text>
  
  <!-- Slack Webhook -->
  <rect x="50" y="480" width="120" height="60" fill="#4A154B" stroke="#333" stroke-width="2" rx="5"/>
  <text x="110" y="515" text-anchor="middle" fill="white" font-size="14">Webhook</text>
  
  <!-- Flow Arrows -->
  <!-- 1. User command -->
  <path d="M 110 140 L 110 200" stroke="#333" stroke-width="2" marker-end="url(#arrow)"/>
  <text x="120" y="170" font-size="12">1. /mcp MC123</text>
  
  <!-- 2. Slack to App -->
  <path d="M 170 230 L 300 230" stroke="#333" stroke-width="2" marker-end="url(#arrow)"/>
  <text x="210" y="220" font-size="12">2. POST</text>
  
  <!-- 3. App to MCP -->
  <path d="M 500 230 L 650 230" stroke="#333" stroke-width="2" marker-end="url(#arrow)"/>
  <text x="550" y="220" font-size="12">3. Get data</text>
  
  <!-- 4. 401 Error -->
  <path d="M 650 250 L 500 340" stroke="red" stroke-width="2" marker-end="url(#arrow)" stroke-dasharray="5,5"/>
  <text x="550" y="300" font-size="12" fill="red">4. 401</text>
  
  <!-- 5. Refresh token -->
  <path d="M 480 360 L 650 350" stroke="blue" stroke-width="2" marker-end="url(#arrow)"/>
  <text x="540" y="350" font-size="12" fill="blue">5. Refresh</text>
  
  <!-- 6. New token back -->
  <path d="M 650 360 L 480 380" stroke="blue" stroke-width="2" marker-end="url(#arrow)" stroke-dasharray="5,5"/>
  <text x="540" y="380" font-size="12" fill="blue">6. New token</text>
  
  <!-- 7. Retry -->
  <path d="M 500 380 L 720 260" stroke="green" stroke-width="2" marker-end="url(#arrow)"/>
  <text x="600" y="320" font-size="12" fill="green">7. Retry</text>
  
  <!-- 8. Success -->
  <path d="M 720 260 L 500 420" stroke="green" stroke-width="2" marker-end="url(#arrow)" stroke-dasharray="5,5"/>
  <text x="600" y="350" font-size="12" fill="green">8. Data</text>
  
  <!-- 9. Send to webhook -->
  <path d="M 320 440 L 170 510" stroke="#333" stroke-width="2" marker-end="url(#arrow)"/>
  <text x="220" y="480" font-size="12">9. Results</text>
  
  <!-- 10. Display to user -->
  <path d="M 110 480 L 110 140" stroke="#333" stroke-width="2" marker-end="url(#arrow)" stroke-dasharray="5,5"/>
  <text x="30" y="310" font-size="12">10. Show</text>
  
  <!-- Legend -->
  <rect x="50" y="600" width="900" height="150" fill="#f5f5f5" stroke="#333" rx="5"/>
  <text x="70" y="630" font-size="14" font-weight="bold">Flow Summary:</text>
  <text x="70" y="655" font-size="12">1. User types /mcp command â†’ 2. Slack posts to Node.js app â†’ 3. App calls MCP API</text>
  <text x="70" y="675" font-size="12">4. If token expired (401) â†’ 5-6. Refresh OAuth token â†’ 7-8. Retry with new token</text>
  <text x="70" y="695" font-size="12">9. Send formatted results to Slack webhook â†’ 10. Display risk assessment to user</text>
  <text x="70" y="720" font-size="12">Risk Levels: ðŸŸ¢ Low (0-124) | ðŸŸ¡ Medium (125-249) | ðŸŸ  Review (250-999) | ðŸ”´ Fail (1000+)</text>
</svg>